# Cymbal Sports Mock API

This is a Mock API representing a fictitious sporting goods store called "Cymbal Sports".
It is designed for use in the "Create a Multi-Agent Application using CX Agent Studio" training class.

The API is built using Python FastAPI and deployed to Google Cloud Run. It uses Google Cloud Firestore for persistence.

## Features

- **Inventory Management**: Save ~100 realistic mock items to Firestore from a CSV.
- **Product Catalog**: Retrieve product details.
- **Cart Management**: Add/Remove items from a user's cart.
- **Order Management**: Get order status and return orders (Mock logic).
- **User Management**: Create accounts and login (Mock auth).

## API Endpoints

Once deployed, you can access the interactive API documentation at:
`https://<YOUR_SERVICE_URL>/docs` (Swagger UI) or `https://<YOUR_SERVICE_URL>/redoc`.

### Key Endpoints:
- `POST /save_inventory`: Initializes the database with mock inventory.
- `GET /products/{item_id}`: Get product details.
- `GET /orders/{order_id}`: Get order status.
- `POST /orders/{order_id}/return`: Return an order.
- `POST /cart/add`: Add item to cart.
- `POST /cart/remove`: Remove item from cart.
- `POST /users`: Create account.
- `POST /login`: Login.

## Setup & Deployment

### Local Development

1. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
2. Set up Firestore credentials (if testing locally):
   ```bash
   export GOOGLE_APPLICATION_CREDENTIALS="path/to/key.json"
   ```
3. Run the app:
   ```bash
   uvicorn app.main:app --reload --port 8080
   ```

### Deployment to Cloud Run

1. Build the container:
   ```bash
   gcloud builds submit --tag gcr.io/PROJECT_ID/cymbal-sports-api
   ```
2. Deploy to Cloud Run:
   ```bash
   gcloud run deploy cymbal-sports-api \
     --image gcr.io/PROJECT_ID/cymbal-sports-api \
     --platform managed \
     --region us-central1 \
     --allow-unauthenticated
   ```

## OpenAPI Specification for Agents

The OpenAPI spec is available at `/openapi.json`. You can use this URL to import the API as a Tool in Conversational Agents (Vertex AI Agents).

Update the server URL in the spec to match your Cloud Run URL.

## Inventory Data

The inventory data is generated by `create_inventory.py` and stored in `app/data/inventory.csv`.


